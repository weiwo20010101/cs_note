# 大数据

## MapReduce

- 最初由谷歌用于分析其搜索结果，后来谷歌开源了bigtable，基于此发展，MapReduce 因其能够并行拆分和处理数 TB 的数据而获得广泛普及，从而更快地获得结果。

- `MapReduce` 不是将数据发送到应用程序或者逻辑所在的位置，而是在数据已经驻留的服务器上执行逻辑，以减少网络传输的开销，加快处理速度。
- `MapReduce`的数据访问和存储基于磁盘，输入通常存储为包含结构化，半结构化，非结构化数据的文件，输出也存储在文件中。

### 原理

MapReduce 的核心是两个函数：Map 和 Reduce。它们一个接一个地排序。

- Map函数将来自磁盘的输入作为 <key,value> 对进行处理，并生成另一组中间 <key,value> 对作为输出。
- Reduce函数还将输入作为 <key,value> 对，并生成 <key,value> 对作为输出。

map 是过滤和排序初始数据的强制性步骤，但 reduce 功能是可选的。

#### Map

映射器：map server

输入数据经过split分为更小的块，（64mb大小），然后每个块分配给映射器进行处理。

例如，如果一个文件有 100 条记录要处理，则可以同时运行 100 个映射器，每个映射器处理一条记录。或者也许 50 个映射器可以一起运行，每个映射器处理两个记录。Hadoop 框架根据要处理的数据大小和每个映射器服务器上可用的内存块来决定使用多少映射器。

或者一个文件640mb，分为10块进行处理，每个块有一个map server。

#### reduce

分配：在所有map server完成处理之后，框架会将结果在传递给reduce之前对结果进行混洗和排序。当mapper仍然在进行中时，reducer无法启动。具有相同key的映射会分配给同一个reducer，然后由该reducer进行聚合。

#### combine/partition/sort

combine 是一个可选过程，可以理解为是在每个map server上单独运行的reducer，在将数据传递到下游之前，将每个map server的数据进一步简化。

partition 是将map server生成的k:v 转换为另外一组k:v以呈现给reducer的过程。默认按照 map server生成的 key的hash值分配partition，有多少个reducer就有多少个parition。

在分发给reducer之前，partition过程会给数据排序。

### 概述


MapReduce 是一种用于处理和生成大型数据集的编程模型和相关实现。用户指定一个 map 函数处理键/值对以生成一组中间键/值对，以及一个 reduce 函数合并与同一中间键关联的所有中间值。如论文中所示，许多现实世界的任务都可以在此模型中表达。

以这种函数式风格编写的程序会自动并行化并在大型商用机器集群上执行。运行时系统负责对输入数据进行分区、安排程序在一组机器上执行、处理机器故障以及管理所需的机器间通信等细节。这使得没有任何并行和分布式系统经验的程序员可以轻松地利用大型分布式系统的资源。

MapReduce 实现运行在大型商品机器集群上，并且具有高度可扩展性：典型的 MapReduce 计算在数千台机器上处理数 TB 的数据。

### 参考与示例

https://www.talend.com/resources/what-is-mapreduce/



