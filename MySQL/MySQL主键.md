# MySQL主键

## 结论

MySQL的自增主键不单调也不连续。

## 原因

1. 不连续是因为可能会出现插入的记录因为唯一键冲突导致了回滚。在并发情况下，线程1插入10，线程2插入11，然后线程1回滚了，就会导致主键id不连续
2. 不单调是因为
   - 在较早的 MySQL 版本中，它的实现还比较简陋，InnoDB 引擎会在内存中存储一个整数表示下一个被分配到的 ID，当客户端向表中插入数据时会获取 `AUTO_INCREMENT` 值并将其加一。导致delete之后的记录id仍然可能被使用
   - 新版本中，对与主键的修改变动会记录在redo log和检查点中，数据库可以从持久化的检查点和redo log中恢复，避免出现不单调的主键。